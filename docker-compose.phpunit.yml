version: "3"

services:
  wordpress_phpunit:
    build:
      context: tools
      dockerfile: phpunit.dockerfile
      args:
        VERSION_PHP: 7.3
        VERSION_PHP_UNIT: 8
    working_dir: /app
    environment:
      WP_CORE_DIR: "/tmp/vendor/johnpbloch/wordpress-core"
      WP_TESTS_PHPUNIT_POLYFILLS_PATH: "/tmp/vendor/yoast/phpunit-polyfills/"
    volumes:
      - "./yesticket/:/app"
      - "./bin/:/mount/bin"
      - "testsuite:/tmp"
  mysql_phpunit:
    image: "mariadb:10.2"
    environment:
      MYSQL_ALLOW_EMPTY_PASSWORD: "yes"
      MYSQL_DATABASE: "wordpress_test"
      MYSQL_ROOT_PASSWORD: "test"

volumes:
  testsuite: {}
